<!DOCTYPE html>
<html>
  <head>
    
    <base target="_top">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
@import url('https://fonts.googleapis.com/css?family=Noto+Sans+HK:500&display=swap');
    *{
      box-sizing: border-box;
    }
    
    body{
    display: flex;
    min-height: 100vh;
    flex-direction: column;
    background-color: whitesmoke;
    color: black;
    font-family: 'Noto Sans HK', sans-serif;
    }

    .input-field inline{
        width: 5px;
    }

    .inline{
        width: 55px;
        height: 100px;

    }
    
    .pageContainer{
      padding: 0 25px;
    }
    
    
    
    .meassures label{
      display: block;
    }
    
    .meass{
    width: 40px;
    text-align: center;
    }
    
    #submit{
    margin-top: 50px;
    
    }
  
  #enterMeassures{
    margin-bottom: 2px;
  }
  
  .inline{
    
     width: 500px;
     
  }
  
  .left{
    width:300px;
    float: left;
    
    
    
  }
  .right{
    width: 150px;
    float: right;
    
  }
        
  #infoMsg{
    
    width: 8vw;
    height: 5vw;
    margin-left:20px;
    
    
              }
              
   .container{
    width: 480px;
   } 

   .masterLeft{
       width: 48%;
       float: left;
       padding-left: 3%;
   }
  
   .masterRight{
    width: 48%;
    float: right;
    padding-right: 3%;
}

.assyChk{
  margin: 44px;
}

    .assy{
      margin: 10%
    }  


  .form-row{
    margin-top: 20px;
    margin-bottom: 20px;
  }
  
  .printEstimation{
  
  }

  .col.s12 > .btn {
   width: 100%;
  }
  
  .btn{
  background-color: #546e7a;
  width: 14em;
  margin: 15px;
  }
 
   .link{
   text-decoration: underline;
   }

  .HomeButtons {
   padding: 20px;
   margin-top: 50px;
  }

  .loading{
   
  height: 10%;
  width: 10%;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
      
  
    }
    
.fixed-action-btn{
  position: absolute;

}

.moreBTP{
  margin-left:27px;
}
  
 .smallBtn{
   width: 8em;
 }
 
 
 /*------------------------------------------------------ Loader--------------------------- */
.loader  {
  border: 8px solid #B0B0B0; /* Light grey */
  border-top: 8px solid #909090; 
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  margin-left: 15%;
  
}

.loadingCalc{
  color: #A0A0A0;
  margin-left: 15%;
  margin-top: 15%;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

      /*----------END----- Loader---- */
      
.volume{
   padding: 15px;
   margin-left: 12%;
   margin-top: 5%;
   background-color: #FFFFFF;
}


h6{
    margin-left: 12px;
}

.loadingG{
  
}
#ifr{
  width: 100%;
  height: 768px;
  
 }
 
 nav{
   background-color: #333;
   height: 80px;
 }
 
 .nav-wrapper{
   display: flex;
   flex-direction: row;
   justify-content: space-between;
   width:100%;
   padding: 10px 25px;
 }
 


.homeBtn{
  position: absolute;
  right: 0;
}

.fixed-action-btn{
    position: sticky;
    left:90%;
    float: right; 
    display: inline-block;
}

.tooltip {
    position: relative;
    display: inline-block;
    
  }
  
  .tooltip .tooltiptext {
    visibility: hidden;
    width: 150px;
    background-color: black;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 5px 0;
    top: -1px;
    left: 100%;
  
    /* Position the tooltip */
    position: absolute;
    z-index: 100;
  }
  
  .tooltip:hover .tooltiptext {
    visibility: visible;
  }
  
  
  /*Customized home buttons*/
  .buttonArrange{
     display: flex;
     flex-direction: row;
     flex-wrap: wrap;
     justify-content: center;
  }
  
  .bigButton{
    display: flex;
    flex-direction: row;
    border-radius: 5px;
    height: 100px;
    width: 200px;
    overflow: hidden;
    margin: 35px;
    box-shadow: 0 3px 5px 1px rgba(0, 0, 0, 0.2);
    transition: all 200ms ease-out;
  }
  
  .bigButton img{
    height: 100px;
    width: 200px;
  }
  
  
  .bigButton:hover {
    box-shadow: 0 0 6px rgb(35 173 255);
}
  
  .buttonText{
    font-size: 2rem;
    color:white;
    text-shadow: 2px 2px 4px #000000;
    position: absolute;
    z-index:100;
  }
 
 #powerIcon{
   color: yellow;
 }

  /* Rules for sizing the icon. */
.material-icons.md-18 { font-size: 18px; }
.material-icons.md-24 { font-size: 24px; }
.material-icons.md-36 { font-size: 36px; }
.material-icons.md-48 { font-size: 48px; }
.md-light { color: rgba(255, 255, 255, 1); }

.goBack{
  color:black;
  padding: 25px;
}

.goBack a{
  color:black;
}

.glow {
  -webkit-animation: glow 1s ease-in-out infinite alternate;
  -moz-animation: glow 1s ease-in-out infinite alternate;
  animation: glow 0.5s ease-in-out infinite alternate;
}

@-webkit-keyframes glow {
  from {
    text-shadow: 0 0 0 #fff, 0 0 0.5px #fff,0 0 1px #f2f278,  0 0 1.5px #f2f278,  0 0 2px #f2f278, 0 0 3px #f2f278, 0 0 4px #f2f278, 0 0 5px #f2f278;
  }
  
  to {
    text-shadow:  0 0 0px #fff, 0 0 0.5px #fff, 0 0 1px yellow, 0 0 1.5px yellow, 0 0 2.5px yellow, 0 0 3.5px yellow;
  }
}

.gif{
  display:flex;
  justify-content: center;
}

#downloadTemplate{
  overflow: hidden;
}

.fa-dollar-sign{
  color: #fff;
  height: 64px;
  line-height: 64px;
}

#slideCeption{
  display: block;
}
</style>  
    <style>
*{
  box-sizing: border-box;
}

main{
  display: flex;
  flex-direction: row;
  
}


.masterLeft{
  padding-left:25px;
  padding-right:25px;
}


.masterRight{
  padding-left:25px;
  padding-right:25px;
}

</style>  
    <script src="https://kit.fontawesome.com/6365c07014.js" crossorigin="anonymous"></script>
    
  </head>
  <body>
  
  <!-- Modal Project RESTART -->
  <div id="modalRestart" class="modal">
    <div class="modal-content">
      <div style="font-size:3rem;text-align:right"> <i class="material-icons right">warning</i> </div> 
      <h4>Atention!</h4>
      <p>This will reset your project. Do you wish to continue?</p>
    </div>
    <div class="modal-footer">
      <a href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=home" class="modal-close btn waves-effect btn-flat deep-orange text-darken-1" id="restart">Yes, restart</a>
      <a class="modal-close btn waves-effect btn-flat green text-darken-1">Cancel</a>
    </div>
  </div>
  
  <!-- Modal INFO -->
  <div id="modalInfo" class="modal">
    <div class="modal-content">
      <div style="font-size:3rem ;text-align:center"> <i class="material-icons md-48 right">info</i> </div> 
      <h5>How to use: Sheet metal estimator</h5><br>
          <h6>Single item estimation</h6>
          <p>This is a good opotion if you wish to get a quick estimation on one or a couple of parts.</p>
          <p>You can estimate your items one part at a time by filling the required parameters on the left.</p>
            <div class="gif"><img src="https://drive.google.com/uc?export=download&id=1RFbl53qjlzBxMMsp52g4Ogz98cyyGs1a"> </div>
          <br>
          <h6>Mass upload</h6>
          <p>You have a list of parts that would take you long enough to estimate one by one?</p>
          <p>Put the required paramenters in the excel template (or google sheet) and you will get your estimatios in seconds.</p>
          <p>Requirements <i class="fas fa-exclamation"></i></p>
          <p>We will need a specific template. You can download or (open in google sheets) this template in the menu bar.</p>
            <div class="gif"><img src="https://drive.google.com/uc?export=download&id=1bEaVh5mlnecFrbPhnehLfDO5I3X1btcU"> </div>
          <p>There are certain rules in the template you need to adhere to, such as picking material, finish type, etc, from the dropwdown menu. Make sure you are selecting valid options.</p>
            <div class="gif"><img src="https://drive.google.com/uc?export=download&id=1kffwJJO-J0LhfSQWdiAVo6L3D0hAFd7N"> </div>
    </div>
    <div class="modal-footer">
      <a class="modal-close btn waves-effect btn-flat green text-darken-1">Got it!</a>
    </div>
  </div>
  
  <!-- Dropdown Structure -->
<ul id="dropdown1" class="dropdown-content">
  <li><a href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=sheet">Sheet metal</a></li>
  <li><a href="#!">Plastics</a></li>
  <li><a href="#!"><i class="material-icons right">work_off</i>Machined </a></li>
  <li><a href="#!"><i class="material-icons right">work_off</i>Part catalogue</a></li>
    <li class="divider"></li> 
  <li><a href="https://drive.google.com/file/d/1DOxVZKSSY67L40yavwRMVv_D7lK7t2vn/view?usp=sharing" id="downloadTemplate" target="_blank" download="">
         Mass upload<i class="far fa-file-excel">
  </i></a></li>
</ul>
<div class="navbar-fixed">
<nav>
  <div class="nav-wrapper">
    <div><a href="#!" class="brand-logo"></a> </div>
    <ul class=" hide-on-med-and-down">
      <!-- Dropdown Trigger -->
      <li><a href="#" data-target="slide-out" id="slideCeption" class="sidenav-trigger"><i class="fas fa-dollar-sign"></i></a></li>
      <li><a class="modal-trigger" href="#modalInfo" id="infoButton"><i class="material-icons md-light glow">info</i></a></li>
      <li><a class="" href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=home"><i class="material-icons">home</i></a></li>
      <li><a class="dropdown-trigger" href="#!" data-target="dropdown1">Menu<i class="material-icons right">arrow_drop_down</i></a></li>
      <li><a class="modal-trigger" href="#modalRestart"><i class="material-icons" id="powerIcon">power_settings_new</i></a></li>
    </ul>
  </div>
</nav>
</div>

<div class="backAndInfo">
  <div class="goBack">
    <a href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=home"> ← Go back </a>
  </div>
</div>  
  
  <!-- SIDE NAV -->
  <ul id="slide-out" class="sidenav">
      <li><div class="user-view">
        <div class="background">
        </div>
        <a href="#user"><img class="circle" alt="someting"></a>
        <a href="#name"><span class="white-text name">John Doe</span></a>
        <a href="#email"><span class="white-text email">jdandturk@gmail.com</span></a>
      </div></li>
      <li><a href="#!"><i class="material-icons">cloud</i>First Link With Icon</a></li>
      <li><a href="#!">Second Link</a></li>
      <li><div class="divider"></div></li>
      <li><a class="subheader">Subheader</a></li>
      <li><a class="waves-effect" href="#!">Third Link With Waves</a></li>
  </ul>
   
<main>   
<!------------MASTER LEFT BEGINS ----------->  
<div class="masterLeft">
 
    <h2> Sheet Metal </h2><br>
    
                         <!--   
                         <div class="fixed-action-btn direction-bottom">
                              <a class="btn-floating btn-large" title="Open Menu"><i class="large material-icons">menu</i></a>
                                <ul>                             
                                <li class="tooltip">
                                  <span class="tooltiptext">Add PCB</span>
                                  <a  class="btn-floating"><i class="material-icons">shopping_cart</i></a>
                                  </li>
                                <li class="tooltip">
                                  <span class="tooltiptext">Add plastic</span>
                                  <a class="btn-floating "><i class="material-icons">shopping_cart</i></a>
                                  </li>
                                <li class="tooltip">
                                  <span class="tooltiptext">Copy G-Sheets link</span>
                                  <a class="btn-floating" id= "copyLink"><i class="material-icons">link</i></a>
                                  </li>
                                <li class="tooltip">
                                  <span class="tooltiptext">Open in G-Sheets</span>
                                  <a class="btn-floating" id="openGS" ><i class="material-icons">open_in_new</i></a>
                                  </li>
                              </ul>
                          </div>
                          -->                       
    
    
    <form id="myForm">
          <div class="row">
            <div class="input-field col s6">
            <i class="material-icons prefix">format_list_numbered</i>   
              <input id="partNumber" type="text" class="validate">
              <label for="partNumber">Part Number</label>
            </div>
          </div>


    <div class="row"> 
            <div class="input-field col s10">
                <i class="material-icons prefix">business_center</i>
                    <select id="strategy" name="strategy" disabled="">
                      <option disabled="" selected="">Select</option>
                      <option value="3">Conservative (room for pricing improvement )</option>
                      <option selected="selected" value="2">Medium (average market matl costs)</option>
                      <option value="1">Agressive (lowest materials & labor costs in the market)</option>
                   </select>
                    <label>Type of Strategy</label>
            </div>
        </div>




<div class="row"> 
    <div class="input-field col s5">
        <i class="material-icons prefix">straighten</i>
            <select id="units" name="units" required="">
              <option disabled="" selected="">Select</option>
              <option value="milimeters">Milimeters (mm)</option>
              <option value="inches">Inches (in)</option>
           </select>
            <label>Units</label>
    </div>
</div><!--END OF MEASSURES SELECTION-->
    

     
    
              <div class="row">
                <div class="input-field col s3">
                <i class="material-icons prefix">trending_flat</i>   
                  <input id="length" type="text" class="validate">
                  <label for="length">Length</label>
                </div>
                <div class="input-field col s3">
                 <i class="material-icons prefix">swap_horiz</i>    
                  <input id="width" type="text" class="validate">
                  <label for="width">Width</label>
                </div>
                <div class="input-field col s3">
                    <i class="material-icons prefix">vertical_align_center</i>  
                        <input id="thickness" type="text" class="validate">
                        <label for="thickness">Thickness</label>
                </div>
              </div> <!--END OF UNITS SELECTION-->

         
       <div class="form-row">
        <i class="material-icons prefix">gradient</i>         
        <label for="material" class="labels"> Material</label>
           <select name="material" id="material">
           <option disabled="" selected="">Select</option>
           <option value="Alu alloy 5052">Alu alloy 5052</option>
           <option value="CRS/SPCC">CRS/SPCC</option>
           <option value="Zinc pre-plating/SECC">Zinc pre-plating/SECC</option>
           <option value="Hot dipped Gal /SGCC">Hot dipped Gal /SGCC</option>
           <option value="Tin pre-plating /SPTE">Tin pre-plating /SPTE</option>
           <option value="Brass /copper">Brass /copper</option>
           <option value="Stainless steel (Sus304/Sus301)">Stainless steel (Sus304/301)</option>
           <option value="Alu alloy 6061">Alu Alloy 6061</option>  
           </select>   
        </div>     <!--END OF MATERIAL SELECTION-->
         
         
         <div class="form-row">  
          <i class="material-icons prefix">texture</i>
           <label for="finishOne" class="labels">Finish type 1 </label>
           <select id="finishOne">
              <option disabled="" selected="">Select</option>
              <option value="Zinc plating ( all types)">Zinc plating ( all types)</option>
              <option value="Chromate/alodine/anodized">Chromate/alodine/anodized</option>
              <option value="Painting (Powder/oil)">Painting (Powder/oil)</option>
              <option value="No finish required (degrease)">No finish required (degrease)</option>
              <option value="Nickel/tin plating">Nickel/tin plating</option>
              <option value="Silkscreen /printing">Silkscreen /printing</option>
           </select>
          </div>  <!--END OF FINISH TYPE SELECTION 1-->
          
        <div class="form-row">  
          <i class="material-icons prefix">texture</i>
           <label for="finishTwo" class="labels">Finish type 2 </label>
           <select id="finishTwo">
              <option disabled="" selected="">Select</option>
              <option value="Zinc plating ( all types)">Zinc plating ( all types)</option>
              <option value="Chromate/alodine/anodized">Chromate/alodine/anodized</option>
              <option value="Painting (Powder/oil)">Painting (Powder/oil)</option>
              <option value="No finish required (degrease)">No finish required (degrease)</option>
              <option value="Nickel/tin plating">Nickel/tin plating</option>
              <option value="Silkscreen /printing">Silkscreen /printing</option>
           </select>
          </div>  <!--END OF FINISH TYPE SELECTION 2-->
         

          <div class="row">
            <div class="input-field col s5">
            <i class="material-icons prefix">change_history</i>   
              <input id="bending" type="text" class="validate">
              <label for="bending"># Bendings</label>
            </div>
            <div class="input-field col s5">
              <i class="material-icons prefix">date_range</i>    
              <input id="EAU" type="text" class="validate">
              <label for="EAU">EAU</label>
            </div>
          </div>

<!-- ENTER NUMBER OF BENDINGS --> 
<!--          EAU       --> 





<!-- TOGGLE HARDWARE OPTION -->         
        
        <p>
         <label for="hide">
         <input type="checkbox" id="hide">
         <span>This part includes hardware</span>
        </label>
    </p>
<!-- CHECKBOX -->   
         
<!-- HARDWARE QTY AND COMPLEXITY-->

   <div id="hdw" class="inline">   
             <div class="row">
                    <div class="input-field col s2">
                      <input id="qtyHdw" type="text" class="validate">
                      <label for="qtyHdw">Quantity</label>
                    </div>
                
        </div> 

      
<div class="container"> <!--CONTAINER-->   
    <div class="left">
        <div class="form-row">    
             <label for="complexity">Complexity</label>  
             <select name="complexity" class="qtyAndType" id="complexity">
             <option selected="" disabled="">Select:</option>
             <option value="Simple">Simple</option>
             <option value="Medium">Medium</option>
             <option value="Complex">Complex</option>
           </select><br><br>
        </div>       
    </div>

    
    
 <div class="right">   
    <div id="infoMsg"></div>
</div>

</div><!--CONTAINER-->       
        
    </div>        
 
    
   <button class="btn waves-effect waves-light" type="submit" id="submit">Estimate
        <i class="material-icons right">attach_money</i>
      </button> <br><br>
    </form>        
    

</div>
<!-----------------END MASTER LEFT-------------> 
<!-----------------BEGIN MASTER RIGHT-------------> 

<div class="masterRight">

<h2>Mass upload</h2><br>

  <form id="uploadFileForm">
      <label for="myfile">Select a file:</label>
    <input type="file" id="myfile" name="myfile"><br><br>
    <div class="gif">
      <p> - or -</p>
    </div>  
      <label for="sheetTemplate">Paste google sheet URL:</label>
    <input type="text" id="sheetTemplate"><br><br>
    <input type="submit" id="massUploadSubmit" class="btn btn-waves">
  </form>

<div class="iframe">
<iframe id="ifr"></iframe>
<!-- width="1024" height="768"  -->
</div>
        
        
  <div class="estimation1"> <br>  
  </div>      
     
   
</div>
<!--END MASTER RIGHT--> 

</main>      
           
   <script>// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
parcelRequire = (function (modules, cache, entry, globalName) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof parcelRequire === 'function' && parcelRequire;
  var nodeRequire = typeof require === 'function' && require;

  function newRequire(name, jumped) {
    if (!cache[name]) {
      if (!modules[name]) {
        // if we cannot find the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof parcelRequire === 'function' && parcelRequire;
        if (!jumped && currentRequire) {
          return currentRequire(name, true);
        }

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) {
          return previousRequire(name, true);
        }

        // Try the node require function if it exists.
        if (nodeRequire && typeof name === 'string') {
          return nodeRequire(name);
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }

      localRequire.resolve = resolve;
      localRequire.cache = {};

      var module = cache[name] = new newRequire.Module(name);

      modules[name][0].call(module.exports, localRequire, module, module.exports, this);
    }

    return cache[name].exports;

    function localRequire(x){
      return newRequire(localRequire.resolve(x));
    }

    function resolve(x){
      return modules[name][1][x] || x;
    }
  }

  function Module(moduleName) {
    this.id = moduleName;
    this.bundle = newRequire;
    this.exports = {};
  }

  newRequire.isParcelRequire = true;
  newRequire.Module = Module;
  newRequire.modules = modules;
  newRequire.cache = cache;
  newRequire.parent = previousRequire;
  newRequire.register = function (id, exports) {
    modules[id] = [function (require, module) {
      module.exports = exports;
    }, {}];
  };

  var error;
  for (var i = 0; i < entry.length; i++) {
    try {
      newRequire(entry[i]);
    } catch (e) {
      // Save first error but execute all entries
      if (!error) {
        error = e;
      }
    }
  }

  if (entry.length) {
    // Expose entry point to Node, AMD or browser globals
    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
    var mainExports = newRequire(entry[entry.length - 1]);

    // CommonJS
    if (typeof exports === "object" && typeof module !== "undefined") {
      module.exports = mainExports;

    // RequireJS
    } else if (typeof define === "function" && define.amd) {
     define(function () {
       return mainExports;
     });

    // <script>
    } else if (globalName) {
      this[globalName] = mainExports;
    }
  }

  // Override the current require with this new one
  parcelRequire = newRequire;

  if (error) {
    // throw error from earlier, _after updating parcelRequire_
    throw error;
  }

  return newRequire;
})({"yHiL":[function(require,module,exports) {
var restart = document.querySelector("#restart");
restart.addEventListener("click", function () {
  localStorage.clear();
}); //Load navbar drowpdown menu

$(document).ready(function () {
  $(".dropdown-trigger").dropdown();
  $('.modal').modal();
  $('.sidenav').sidenav();
}); // // Input File - Get file ready to submit
// var myfile = document.querySelector("#myfile")
// myfile.addEventListener("change", function (e){
//   console.log(myfile.files)
// });
//Info Button turn off glow

var infoButton = document.querySelector("#infoButton");
infoButton.addEventListener("click", function (e) {
  e.target.classList.remove("glow");
});
var qims;

if (localStorage.getItem("projNum")) {
  qims = localStorage.getItem("projNum");
} //Initialize floating Action Button    


document.addEventListener('DOMContentLoaded', function () {
  var elems = document.querySelectorAll('.fixed-action-btn');
  var instances = M.FloatingActionButton.init(elems, {
    direction: 'bottom',
    hoverEnabled: false
  });
});
var googleSheetURL = localStorage.getItem("url");
var projNum = localStorage.getItem("projNum");
var copyLink = document.querySelector('#copyLink');
/*
copyLink.addEventListener('click', function(){ 
  let link = $('<input>').val(googleSheetURL).appendTo('body').css('display', 'none').select();
    document.execCommand('copy');
    alert('Google sheet link copied to clipboard!');
});
*/

document.addEventListener('DOMContentLoaded', function () {
  var elems = document.querySelectorAll('select');
  var instances = M.FormSelect.init(elems);
}); //Project number in navbar

var brandLogo = document.querySelector(".brand-logo");
brandLogo.innerText = qims;
var arr = [];
var myForm = document.querySelector('#myForm'); //var addMore = document.querySelector("#addMore");

var hdw = document.getElementById("hdw");
hdw.style.display = "none";
var iframe = document.querySelector(".iframe");
var ifr = document.querySelector("#ifr");
iframe.style.display = "none";
document.getElementById("infoMsg").style.display = "block";
document.getElementById("infoMsg").style.display = "none";
var hide = document.querySelector('#hide');
/*
let openGS = document.querySelector('#openGS');
openGS.href = googleSheetURL;
openGS.target = '_blank';
*/
//Toggle Hardware option    

hide.addEventListener("click", toggle);

function toggle() {
  if (hdw.style.display === 'block') {
    hdw.style.display = 'none';
  } else {
    hdw.style.display = 'block';
  }
}
/*
//Toggle -Add more BTP Button        
 addMore.addEventListener("click",function(){
     if(moreBTP.style.display === 'block'){
         moreBTP.style.display = 'none';
     }else{
       moreBTP.style.display = 'block';
       }
 });     
 */
//Show Information square


document.getElementById('complexity').addEventListener("change", toggleInfoSqr);

function toggleInfoSqr() {
  var value = document.getElementById('complexity').value;

  if (value === 'Simple') {
    document.getElementById("infoMsg").innerHTML = "ⓘ   Simple to install items such as screws.";
    document.getElementById("infoMsg").style.display = "inline-block";
  } else if (value === 'Medium') {
    document.getElementById("infoMsg").innerHTML = "ⓘ    Medium complexity items, rivetting.";
    document.getElementById("infoMsg").style.display = "inline-block";
  } else if (value === 'Complex') {
    document.getElementById("infoMsg").innerHTML = "ⓘ Complex items including soldering.";
    document.getElementById("infoMsg").style.display = "inline-block";
  }
} //     ESTIMATE BUTTON , SUBMIT OBJECT WITH VALUE TO SERVER


document.getElementById('submit').addEventListener("click", estimate); //SHOW PRICING AS SUBMITTED

/*
const yourEstimation = document.querySelector('.yourEst');
yourEstimation.style.display = 'none';
*/

var i = 0;

function estimate(e) {
  e.preventDefault();
  var userInfo = {};
  var ids = document.querySelectorAll('*[id]');
  ids.forEach(function (element) {
    if (element.id.length < 15) {
      userInfo[element.id] = element.value;
    }
  }); //ADD THE googleSheet -URL TO THE userInfo OBJECT
  //userInfo.googleSheetURL = googleSheetURL;   

  userInfo.hide = e.target.checked; //  google.script.run.estimate(userInfo);

  i++;
  google.script.run.withSuccessHandler(printEstimate).estimate(userInfo);
} //TOGGLE PRICE ON MASTER RIGHT


var estimation = document.querySelector('.estimation1');
estimation.style.display = 'none';

function printEstimate(userInfo) {
  iframe.style.display = "block";
  yourEstimation.style.display = 'block';
  /*
  estimation.style.display = 'block';
  //exp.style.display = 'block';
   //var googleSheetURL = localStorage.getItem("url");
   //console.log(googleSheetURL)
  var price = document.createElement('div');
  price.classList.add('printEstimation');
        //Material: ${userInfo.material} with ${userInfo.bending} bendings. Hardware: ${userInfo.hide === true ? 'Yes' : 'No'}
        //Sheet Area: ${Math.round(userInfo.surfaceArea *1000 )/1000}m², Total Volume: ${Math.round(userInfo.weight *1000)/1000}Kgs, 
  price.innerText  = `Part Number ${userInfo.partNumber} | Estimated Price$: ${Math.round(userInfo.estimation * 1000)/1000} 
  
  `;
  
  estimation.prepend(price);
  */

  var jason = JSON.stringify(userInfo);
  arr.push(jason);
  console.log(arr); //CALL TOGS

  google.script.run.toGS(arr, googleSheetURL);
  ifr.src = googleSheetURL;
  myForm.reset();
}
},{}]},{},["yHiL"], null)</script>
   <script>// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
parcelRequire = (function (modules, cache, entry, globalName) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof parcelRequire === 'function' && parcelRequire;
  var nodeRequire = typeof require === 'function' && require;

  function newRequire(name, jumped) {
    if (!cache[name]) {
      if (!modules[name]) {
        // if we cannot find the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof parcelRequire === 'function' && parcelRequire;
        if (!jumped && currentRequire) {
          return currentRequire(name, true);
        }

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) {
          return previousRequire(name, true);
        }

        // Try the node require function if it exists.
        if (nodeRequire && typeof name === 'string') {
          return nodeRequire(name);
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }

      localRequire.resolve = resolve;
      localRequire.cache = {};

      var module = cache[name] = new newRequire.Module(name);

      modules[name][0].call(module.exports, localRequire, module, module.exports, this);
    }

    return cache[name].exports;

    function localRequire(x){
      return newRequire(localRequire.resolve(x));
    }

    function resolve(x){
      return modules[name][1][x] || x;
    }
  }

  function Module(moduleName) {
    this.id = moduleName;
    this.bundle = newRequire;
    this.exports = {};
  }

  newRequire.isParcelRequire = true;
  newRequire.Module = Module;
  newRequire.modules = modules;
  newRequire.cache = cache;
  newRequire.parent = previousRequire;
  newRequire.register = function (id, exports) {
    modules[id] = [function (require, module) {
      module.exports = exports;
    }, {}];
  };

  var error;
  for (var i = 0; i < entry.length; i++) {
    try {
      newRequire(entry[i]);
    } catch (e) {
      // Save first error but execute all entries
      if (!error) {
        error = e;
      }
    }
  }

  if (entry.length) {
    // Expose entry point to Node, AMD or browser globals
    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
    var mainExports = newRequire(entry[entry.length - 1]);

    // CommonJS
    if (typeof exports === "object" && typeof module !== "undefined") {
      module.exports = mainExports;

    // RequireJS
    } else if (typeof define === "function" && define.amd) {
     define(function () {
       return mainExports;
     });

    // <script>
    } else if (globalName) {
      this[globalName] = mainExports;
    }
  }

  // Override the current require with this new one
  parcelRequire = newRequire;

  if (error) {
    // throw error from earlier, _after updating parcelRequire_
    throw error;
  }

  return newRequire;
})({"gCHb":[function(require,module,exports) {
//Get XLS from input and listen for submit file
var uploadFileForm = document.querySelector("#uploadFileForm");
var massUploadSubmit = document.querySelector("#massUploadSubmit");
var myfile = document.querySelector("#myfile"); // uploadFileForm.addEventListener('submit', e =>{
//     e.preventDefault();
//     e.stopPropagation();
//     console.log(myfile.files); 
//     const file = myfile.files[0];
//     const fileReader = new FileReader();
//     fileReader.onload = (e)=>{
//         const obj = {
//             filename: file.name,
//             mimeType: file.type,
//             bytes: [... new Int8Array(e.target.result)]
//         };
//         google.script.run.withSuccessHandler(e => console.log(e).saveFile(obj))
//     };
//     fileReader.readAsArrayBuffer(file)
// })

uploadFileForm.addEventListener('submit', function (e) {
  e.preventDefault();
  e.stopPropagation();
  var file = myfile.files[0];
  var fileReader = new FileReader();
  var pNum = localStorage.getItem("projNum") || "test123";

  fileReader.onload = function () {
    google.script.run.withSuccessHandler(function () {
      console.log("done");
    }).saveFile(fileReader.result, file.type, pNum + "mass upload");
  };

  fileReader.readAsText(file);
});
},{}]},{},["gCHb"], null)</script>
   <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
   <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  </body>
</html>