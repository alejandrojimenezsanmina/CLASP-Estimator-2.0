<html>
  <head>
    
    <base target="_top">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
@import url('https://fonts.googleapis.com/css?family=Noto+Sans+HK:500&display=swap');
    *{
      box-sizing: border-box;
    }
    
    body{
    display: flex;
    min-height: 100vh;
    flex-direction: column;
    background-color: whitesmoke;
    color: black;
    font-family: 'Noto Sans HK', sans-serif;
    }

    .input-field inline{
        width: 5px;
    }

    .inline{
        width: 55px;
        height: 100px;

    }
    
    .pageContainer{
      padding: 0 25px;
    }
    
    
    
    .meassures label{
      display: block;
    }
    
    .meass{
    width: 40px;
    text-align: center;
    }
    
    #submit{
    margin-top: 50px;
    
    }
  
  #enterMeassures{
    margin-bottom: 2px;
  }
  
  .inline{
    
     width: 500px;
     
  }
  
  .left{
    width:300px;
    float: left;
    
    
    
  }
  .right{
    width: 150px;
    float: right;
    
  }
        
  #infoMsg{
    
    width: 8vw;
    height: 5vw;
    margin-left:20px;
    
    
              }
              
   .container{
    width: 480px;
   } 

   .masterLeft{
       width: 48%;
       float: left;
       padding-left: 3%;
   }
  
   .masterRight{
    width: 48%;
    float: right;
    padding-right: 3%;
}

.assyChk{
  margin: 44px;
}

    .assy{
      margin: 10%
    }  


  .form-row{
    margin-top: 20px;
    margin-bottom: 20px;
  }
  
  .printEstimation{
  
  }

  .col.s12 > .btn {
   width: 100%;
  }
  
  .btn{
  background-color: #546e7a;
  width: 14em;
  margin: 15px;
  }
 
   .link{
   text-decoration: underline;
   }

  .HomeButtons {
   padding: 20px;
   margin-top: 50px;
  }

  .loading{
   
  height: 10%;
  width: 10%;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
      
  
    }
    
.fixed-action-btn{
  position: absolute;

}

.moreBTP{
  margin-left:27px;
}
  
 .smallBtn{
   width: 8em;
 }
 
 
 /*------------------------------------------------------ Loader--------------------------- */
.loader  {
  border: 8px solid #B0B0B0; /* Light grey */
  border-top: 8px solid #909090; 
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  margin-left: 15%;
  
}

.loadingCalc{
  color: #A0A0A0;
  margin-left: 15%;
  margin-top: 15%;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

      /*----------END----- Loader---- */
      
.volume{
   padding: 15px;
   margin-left: 12%;
   margin-top: 5%;
   background-color: #FFFFFF;
}


h6{
    margin-left: 12px;
}

.loadingG{
  
}
#ifr{
  width: 100%;
  height: 768px;
  
 }
 
 nav{
   background-color: #333;
   height: 80px;
 }
 
 .nav-wrapper{
   display: flex;
   flex-direction: row;
   justify-content: space-between;
   width:100%;
   padding: 10px 25px;
 }
 


.homeBtn{
  position: absolute;
  right: 0;
}

.fixed-action-btn{
    position: sticky;
    left:90%;
    float: right; 
    display: inline-block;
}

.tooltip {
    position: relative;
    display: inline-block;
    
  }
  
  .tooltip .tooltiptext {
    visibility: hidden;
    width: 150px;
    background-color: black;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 5px 0;
    top: -1px;
    left: 100%;
  
    /* Position the tooltip */
    position: absolute;
    z-index: 100;
  }
  
  .tooltip:hover .tooltiptext {
    visibility: visible;
  }
  
  
  /*Customized home buttons*/
  .buttonArrange{
     display: flex;
     flex-direction: row;
     flex-wrap: wrap;
     justify-content: center;
  }
  
  .bigButton{
    display: flex;
    flex-direction: row;
    border-radius: 5px;
    height: 100px;
    width: 200px;
    overflow: hidden;
    margin: 35px;
    box-shadow: 0 3px 5px 1px rgba(0, 0, 0, 0.2);
    transition: all 200ms ease-out;
  }
  
  .bigButton img{
    height: 100px;
    width: 200px;
  }
  
  
  .bigButton:hover {
    box-shadow: 0 0 6px rgb(35 173 255);
}
  
  .buttonText{
    font-size: 2rem;
    color:white;
    text-shadow: 2px 2px 4px #000000;
    position: absolute;
    z-index:100;
  }
 
 #powerIcon{
   color: yellow;
 }

  /* Rules for sizing the icon. */
.material-icons.md-18 { font-size: 18px; }
.material-icons.md-24 { font-size: 24px; }
.material-icons.md-36 { font-size: 36px; }
.material-icons.md-48 { font-size: 48px; }
.md-light { color: rgba(255, 255, 255, 1); }

.goBack{
  color:black;
  padding: 25px;
}

.goBack a{
  color:black;
}

.glow {
  -webkit-animation: glow 1s ease-in-out infinite alternate;
  -moz-animation: glow 1s ease-in-out infinite alternate;
  animation: glow 0.5s ease-in-out infinite alternate;
}

@-webkit-keyframes glow {
  from {
    text-shadow: 0 0 0 #fff, 0 0 0.5px #fff,0 0 1px #f2f278,  0 0 1.5px #f2f278,  0 0 2px #f2f278, 0 0 3px #f2f278. 0 0 4px #f2f278, 0 0 5px #f2f278;
  }
  
  to {
    text-shadow:  0 0 0px #fff, 0 0 0.5px #fff, 0 0 1px yellow, 0 0 1.5px yellow, 0 0 2.5px yellow, 0 0 3.5px yellow;
  }
}

.glowGreen{
  -webkit-animation: glowGreen 1s ease-in-out infinite alternate;
  -moz-animation: glowGreen 1s ease-in-out infinite alternate;
  animation: glowGreen 0.5s ease-in-out infinite alternate;
}

@-webkit-keyframes glowGreen {
  from {
    text-shadow: 0 0 0.5px #fff, 0 0 1px #fff, 0 0 1.5px greenyellow, 0 0 2px greenyellow, 0 0 2.5px greenyellow, 0 0 3px greenyellow, 0 0 3.5px greenyellow;
  }
  to {
    text-shadow: 0 0 5px #fff, 0 0 5px #deff65, 0 0 7.5px #deff65, 0 0 10x #deff65, 0 0 12.5px #deff65, 0 0 15px #deff65, 0 0 17.5px #deff65;
  }
}

#slideCeption{
  display: block;
}


.gif{
  display:flex;
  justify-content: center;
}

#downloadTemplate{
  overflow: hidden;
}

.fa-dollar-sign{
  color: #fff;
  height: 64px;
  line-height: 64px;
}

 body {
    display: flex;
    min-height: 100vh;
    flex-direction: column;
  }

  main {
    flex: 1 0 auto;
  }

  .userIconAndName{
    display: flex;

    align-items: center;
    
  }

  #userIcon{

  }
 #userName{
   
  
 }</style>
    <script src="https://kit.fontawesome.com/6365c07014.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
  </head>
  
  <body>
  <header>
 <!-- Modal Project RESTART -->
 <div id="modalRestart" class="modal">
  <div class="modal-content">
    <div style="font-size:3rem;text-align:right"> <i class="material-icons right">warning</i> </div> 
    <h4>Atention!</h4>
    <p>This will reset your project. Do you wish to continue?</p>
  </div>
  <div class="modal-footer">
    <a href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=home" class="modal-close btn waves-effect btn-flat deep-orange text-darken-1" id="restart">Yes, restart</a>
    <a class="modal-close btn waves-effect btn-flat green text-darken-1">Cancel</a>
  </div>
</div>

<!-- Modal INFO -->
<div id="modalInfo" class="modal">
  <div class="modal-content">
    <div style="font-size:3rem ;text-align:center"> <i class="material-icons md-48 right">info</i> </div> 
    <h5>How to use: Sheet metal estimator</h5><br>
        <h6>Single item estimation</h6>
        <p>This is a good opotion if you wish to get a quick estimation on one or a couple of parts.</p>
        <p>You can estimate your items one part at a time by filling the required parameters on the left.</p>
          <div class="gif"><img src="https://drive.google.com/uc?export=download&id=1RFbl53qjlzBxMMsp52g4Ogz98cyyGs1a"> </div>
        <br>
        <h6>Mass upload</h6>
        <p>You have a list of parts that would take you long enough to estimate one by one?</p>
        <p>Put the required paramenters in the excel template (or google sheet) and you will get your estimatios in seconds.</p>
        <p>Requirements <i class="fas fa-exclamation"></i></p>
        <p>We will need a specific template. You can download or (open in google sheets) this template in the menu bar.</p>
          <div class="gif"><img src="https://drive.google.com/uc?export=download&id=1bEaVh5mlnecFrbPhnehLfDO5I3X1btcU"> </div>
        <p>There are certain rules in the template you need to adhere to, such as picking material, finish type, etc, from the dropwdown menu. Make sure you are selecting valid options.</p>
          <div class="gif"><img src="https://drive.google.com/uc?export=download&id=1kffwJJO-J0LhfSQWdiAVo6L3D0hAFd7N"> </div>
  </div>
  <div class="modal-footer">
    <a class="modal-close btn waves-effect btn-flat green text-darken-1">Got it!</a>
  </div>
</div>

<!-- Dropdown Structure -->
<ul id="dropdown1" class="dropdown-content">
<li><a href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=sheet">Sheet metal</a></li>
<li><a href="#!">Plastics</a></li>
<li><a href="#!"><i class="material-icons right">work_off</i>Machined </a></li>
<li><a href="#!"><i class="material-icons right">work_off</i>Part catalogue</a></li>
  <li class="divider"></li> 
<li><a href="https://drive.google.com/file/d/1DOxVZKSSY67L40yavwRMVv_D7lK7t2vn/export?format=xlsx" id="downloadTemplate" target="_blank" download="">
       Mass upload<i class="far fa-file-excel">
</i></a></li>
</ul>
<div class="navbar-fixed">
<nav>
<div class="nav-wrapper">
  <div><a href="#!" class="brand-logo"></a> </div>
  <ul class=" hide-on-med-and-down">
    <!-- Dropdown Trigger -->
    <li><a href="#" data-target="slide-out" id="slideCeption" class="sidenav-trigger"><i class="fas fa-dollar-sign "></i></a></li>
    <li><a class="" href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=home"><i class="material-icons">home</i></a></li>
    <li id="dropDownMenu"><a class="dropdown-trigger" href="#!" data-target="dropdown1">Menu<i class="material-icons right">arrow_drop_down</i></a></li>
    <li><a class="modal-trigger" href="#modalRestart"><i class="material-icons" id="powerIcon">power_settings_new</i></a></li>
  </ul>
</div>
</nav>
</div>
  

<!-- SIDE NAV -->
<ul id="slide-out" class="sidenav">
    <li><div class="user-view">
      <div class="background">
        <img src="https://drive.google.com/uc?export=download&id=1X2E0RU1woNs7_zmDJq4ylMfblZjrndTd" alt="estimations">
      </div>
      <br><br><br>
      <div class="projNumSideBar"><h6 id="projNumHeader"></h6></div>
      
      <h5> Estimated prices </h5>
      <br>
    </div></li>
    <li><a id="openGSheets"><i class="material-icons">cloud</i>Open in google sheets</a></li>
    <li><a id="downloadXls" download="" target="_blank"><i class="material-icons">download</i>Download excel</a></li>
    <li><a id="sendEmail"><i class="material-icons">email</i> Send me via email </a></li>
    <br>
    <li><div class="divider"></div></li>
    <li><a class="subheader">Latest Estimations</a></li>
    <li>Part Number</li>
    <!-- <li><a class="waves-effect" href="#!">Third Link With Waves</a></li> -->
</ul>
</header>
<main>      
    <div class="pageContainer"> 
      
       <h3> Estimator Tool </h3>     
      <!--Buttons --> 
        <form>
             <div class="projectNumber">
               <div class="row">
                  <div class="input-field col s3">
                   <i class="material-icons prefix">account_balance_wallet</i>   
                    <input id="project" type="text" value="Q-IMS-" class="validate project" required=""> 
                    <label for="project">Proj #: </label>
                    <span class="helper-text" data-error="wrong" data-success="Enter project number and click on start">Format Q-IMS-#</span>
                  </div>
                       <button class="startButton btn waves-effect waves-light">Start
                       </button> 
               </div>
             </div>
        </form>
                        

         
      <!--Loader -->   
  
        
       <!-- <p class="loading">Loading Google Services </p>
           -->
           
           
       
       <img src="https://drive.google.com/uc?export=download&id=1TrU5MK1p7B7tnlGsHyXC-8xtQF5FrFIB" class="loading">
       
  

      <!--Home Buttons DIV -->      <!--REMOVE  animate-bottom-->  
      
      <div class="HomeButtons animate-bottom">
      
        <div class="buttonArrange">
        
         <div class="bigButton">
           <div>
             <a href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=sheet">
               <img src="https://drive.google.com/uc?export=download&id=1YSQMAH8dI0BqCRbA8yRAxOMgvPMW94z_">
             </a>
           </div>
           <div class="buttonText">
             Sheet metal
           </div>
         </div>
         
         <div class="bigButton">
           <div>
             <a href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=plastics">
               <img src="https://drive.google.com/uc?export=download&id=1uSNAA1lg_1UK594P50Mx8-gD170fEd9-">
             </a>
           </div>
           <div class="buttonText">
             Plastics
           </div>
         </div>
         
         <div class="bigButton">
           <div>
             <a href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=machined">
               <img src="https://drive.google.com/uc?export=download&id=1oJThIj1uFwWu0jED733C4Ees0bk9MSB4">
               <!-- <img src="https://drive.google.com/uc?export=download&id=1Bh1_13whbIyJv01W1dBILr11skQG_u-7"/> -->
             </a>
           </div>
           <div class="buttonText">
             Machined
           </div>
         </div>
             
         <div class="bigButton">
          <div>
            <a href="https://script.google.com/a/sanmina.com/macros/s/AKfycbwIwsG7uxBM-iQaCAocMKx2k8ZAnMZxeVSs7nJn1ege/dev?v=partcatalogue">
              <img src="https://drive.google.com/uc?export=download&id=1Bh1_13whbIyJv01W1dBILr11skQG_u-7">
            </a>
          </div>
          <div class="buttonText">
            Part catalogue
          </div>
        </div>
         
        </div>
         <!--end of buttonArrange-->
         
      </div>    
      <!--End of HomeButtons DIV-->
      
  </div>
  <!-- end of containter-->
</main>
  <!--Footer  begins-->
  <footer class="page-footer transparent">
          <div class="footer-copyright">
            <div class="container grey-text text-darken-2">
            2020 Global Quote Team
            </div>
            <div class="container grey-text text-darken-2">
              Estimator tool v 2.0
            </div>
          </div>
</footer>
   <!--Footer  ends-->         
  
   <script>// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
parcelRequire = (function (modules, cache, entry, globalName) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof parcelRequire === 'function' && parcelRequire;
  var nodeRequire = typeof require === 'function' && require;

  function newRequire(name, jumped) {
    if (!cache[name]) {
      if (!modules[name]) {
        // if we cannot find the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof parcelRequire === 'function' && parcelRequire;
        if (!jumped && currentRequire) {
          return currentRequire(name, true);
        }

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) {
          return previousRequire(name, true);
        }

        // Try the node require function if it exists.
        if (nodeRequire && typeof name === 'string') {
          return nodeRequire(name);
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }

      localRequire.resolve = resolve;
      localRequire.cache = {};

      var module = cache[name] = new newRequire.Module(name);

      modules[name][0].call(module.exports, localRequire, module, module.exports, this);
    }

    return cache[name].exports;

    function localRequire(x){
      return newRequire(localRequire.resolve(x));
    }

    function resolve(x){
      return modules[name][1][x] || x;
    }
  }

  function Module(moduleName) {
    this.id = moduleName;
    this.bundle = newRequire;
    this.exports = {};
  }

  newRequire.isParcelRequire = true;
  newRequire.Module = Module;
  newRequire.modules = modules;
  newRequire.cache = cache;
  newRequire.parent = previousRequire;
  newRequire.register = function (id, exports) {
    modules[id] = [function (require, module) {
      module.exports = exports;
    }, {}];
  };

  var error;
  for (var i = 0; i < entry.length; i++) {
    try {
      newRequire(entry[i]);
    } catch (e) {
      // Save first error but execute all entries
      if (!error) {
        error = e;
      }
    }
  }

  if (entry.length) {
    // Expose entry point to Node, AMD or browser globals
    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
    var mainExports = newRequire(entry[entry.length - 1]);

    // CommonJS
    if (typeof exports === "object" && typeof module !== "undefined") {
      module.exports = mainExports;

    // RequireJS
    } else if (typeof define === "function" && define.amd) {
     define(function () {
       return mainExports;
     });

    // <script>
    } else if (globalName) {
      this[globalName] = mainExports;
    }
  }

  // Override the current require with this new one
  parcelRequire = newRequire;

  if (error) {
    // throw error from earlier, _after updating parcelRequire_
    throw error;
  }

  return newRequire;
})({"MypH":[function(require,module,exports) {
//Load navbar drowpdown menu
$(document).ready(function () {
  $(".dropdown-trigger").dropdown();
  $('.modal').modal();
  $('.sidenav').sidenav();
  var projectURL;

  if (localStorage.getItem('url')) {
    projectURL = localStorage.getItem('url');
  }

  if (!projectURL) {
    if (document.querySelector('#dropDownMenu')) {
      document.querySelector('#dropDownMenu').style.display = 'none';
    }
  }

  var restart = document.querySelector("#restart");
  restart.addEventListener("click", function () {
    localStorage.clear();
  }); //Info Button turn off glow

  if (document.querySelector("#infoButton")) {
    var infoButton = document.querySelector("#infoButton");
    infoButton.addEventListener("click", function (e) {
      e.target.classList.remove("glow");
    });
  }

  var dollarSign = document.querySelector('#slideCeption');
  dollarSign.addEventListener("click", function (e) {
    if (dollarSign.classList.contains('glowGreen')) {
      dollarSign.classList.remove("glowGreen");
    }
  });
  var qims;

  if (localStorage.getItem("projNum")) {
    qims = localStorage.getItem("projNum");
  } else {
    qims = "New Project";
  } //Project number in navbar


  var brandLogo = document.querySelector(".brand-logo");
  brandLogo.innerText = qims;
});
},{}]},{},["MypH"], null)</script>        
   <script>// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
parcelRequire = (function (modules, cache, entry, globalName) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof parcelRequire === 'function' && parcelRequire;
  var nodeRequire = typeof require === 'function' && require;

  function newRequire(name, jumped) {
    if (!cache[name]) {
      if (!modules[name]) {
        // if we cannot find the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof parcelRequire === 'function' && parcelRequire;
        if (!jumped && currentRequire) {
          return currentRequire(name, true);
        }

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) {
          return previousRequire(name, true);
        }

        // Try the node require function if it exists.
        if (nodeRequire && typeof name === 'string') {
          return nodeRequire(name);
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }

      localRequire.resolve = resolve;
      localRequire.cache = {};

      var module = cache[name] = new newRequire.Module(name);

      modules[name][0].call(module.exports, localRequire, module, module.exports, this);
    }

    return cache[name].exports;

    function localRequire(x){
      return newRequire(localRequire.resolve(x));
    }

    function resolve(x){
      return modules[name][1][x] || x;
    }
  }

  function Module(moduleName) {
    this.id = moduleName;
    this.bundle = newRequire;
    this.exports = {};
  }

  newRequire.isParcelRequire = true;
  newRequire.Module = Module;
  newRequire.modules = modules;
  newRequire.cache = cache;
  newRequire.parent = previousRequire;
  newRequire.register = function (id, exports) {
    modules[id] = [function (require, module) {
      module.exports = exports;
    }, {}];
  };

  var error;
  for (var i = 0; i < entry.length; i++) {
    try {
      newRequire(entry[i]);
    } catch (e) {
      // Save first error but execute all entries
      if (!error) {
        error = e;
      }
    }
  }

  if (entry.length) {
    // Expose entry point to Node, AMD or browser globals
    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
    var mainExports = newRequire(entry[entry.length - 1]);

    // CommonJS
    if (typeof exports === "object" && typeof module !== "undefined") {
      module.exports = mainExports;

    // RequireJS
    } else if (typeof define === "function" && define.amd) {
     define(function () {
       return mainExports;
     });

    // <script>
    } else if (globalName) {
      this[globalName] = mainExports;
    }
  }

  // Override the current require with this new one
  parcelRequire = newRequire;

  if (error) {
    // throw error from earlier, _after updating parcelRequire_
    throw error;
  }

  return newRequire;
})({"rc9d":[function(require,module,exports) {
var restart = document.querySelector("#restart");
restart.addEventListener("click", function () {
  localStorage.clear();
});
$(document).ready(function () {
  $(".dropdown-trigger").dropdown();
  $('.modal').modal();
  google.script.run.withSuccessHandler(updateUserInfo).getUserInfo();
});

function updateUserInfo(user) {
  if (user) {
    localStorage.setItem("userEmail", user);
  }
}

var userEmail;
var sheetUrl;
var qims;
userEmail = localStorage.getItem("userEmail") || "User";

if (localStorage.getItem("url")) {
  sheetUrl = localStorage.getItem("url");
}

if (localStorage.getItem("projNum")) {
  qims = localStorage.getItem("projNum");
} else {
  qims = "";
} //Project Number DIV = Input Proj #


var projectNumber = document.querySelector('.projectNumber');
var brandLogo = document.querySelector('.brand-logo');
var body = document.body;
var loading = document.querySelector('.loading');
loading.style.display = 'none'; // Hiding Loader

var loader = document.querySelector('.loader'); //loader.style.display = 'none';
//Hiding buttons in home

var homeButtons = document.querySelector('.HomeButtons');
homeButtons.style.display = 'none'; //hiding start button

var startButton = document.querySelector('.startButton');
startButton.style.display = 'none';
body.style.background = '#EFEFEF'; //Project number in navbar

var brandLogo = document.querySelector(".brand-logo");
brandLogo.innerText = qims;
var projNumHeader = document.querySelector('#projNumHeader');
var openGSheets = document.querySelector('#openGSheets');
var downloadXls = document.querySelector('#downloadXls');
var sendEmail = document.querySelector('#sendEmail');

if (sheetUrl) {
  openGSheets.href = sheetUrl;
  openGSheets.target = "_blank";
  var indexof = sheetUrl.indexOf("edit?");
  var substr = sheetUrl.slice(0, indexof);
  var downloadRoute = substr + "export?format=xlsx";
  downloadXls.href = downloadRoute;
}

if (qims) {
  projNumHeader.innerText = qims;
} //If Project # > 5 show Start button


var project = document.querySelector('.project');
project.addEventListener("input", function (e) {
  if (e.target.value.length >= 5) {
    startButton.style.display = 'block';
    qims = e.target.value;
  }
}); //Project Number DIV = Input Proj #

var projectNumber = document.querySelector('.projectNumber'); //Start Button clicked, show all buttons, replace for Actual proj # when clicked // Call start() in order to create a new Google Sheet to paste all the info

startButton.addEventListener("click", function (e) {
  e.preventDefault();
  e.stopPropagation();
  body.style.background = '#EFEFEF';
  loading.style.display = 'block'; //homeButtons.style.display = 'block'; --Moved to function returnGSUrl. This will display until google sheet is loaded
  //projectNumber.innerHTML = `<h5> Proj#: ${qims} </h5>`;

  localStorage.setItem("projNum", qims); //projectNumber.style.display = 'block';             

  google.script.run.withSuccessHandler(returnGSUrl).start(qims);
}); // This funciton returns the URL of the Google Sheet where the estimations are put into.

function returnGSUrl(url) {
  sheetUrl = url;
  localStorage.setItem("url", sheetUrl);
  loading.style.display = 'none';
  homeButtons.style.display = 'block';
  body.style.background = 'whitesmoke';
  projectNumber.style.display = 'none';
  brandLogo.innerText = qims;
}

if (sheetUrl) {
  projectNumber.style.display = "none";
  startButton.style.display = "none";
  body.style.background = '#EFEFEF'; //loading.style.display = 'block';
  //homeButtons.style.display = 'block'; --Moved to function returnGSUrl. This will display until google sheet is loaded
  //projectNumber.innerHTML = `<h5> Proj#: ${qims} </h5>`;

  localStorage.setItem("projNum", qims);
  homeButtons.style.display = 'block';
  body.style.background = 'whitesmoke';
}
},{}]},{},["rc9d"], null)</script>
   <script src="https://ajax.googleapis.com/ajax/libs/d3js/6.3.1/d3.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
 
 
  </body>
</html>
